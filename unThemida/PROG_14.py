#!/usr/bin/python3

#105952a0

import sys
import TVM

def FNC(state, log):
	eip = state.reg4[TVM.R_EIP]
	if eip == 0xB79:
		log.append("\n#FUN_10058950     \n")

		tmp = state.esp
		log.append(hex(state.esp))
		state.push(0xFF0F0000) #eflags
		state.push(0xFF1F0000) #eax
		state.push(0xFF2F0000) #ecx
		state.push(0xFF3F0000) #edx
		state.push(0xFF4F0000) #ebx
		state.push(tmp) #esp
		state.push(0xFF6F0000) #ebp
		state.push(0xFF7F0000) #esi
		state.push(0xFF8F0000) #edi
		
		state.AddRoute(0x444, 0x141bca1 - 0x141b11e)
		log.append("#Jump to route {:02X}".format(0x141bca1 - 0x141b11e))
	elif eip == 0xD19:
		log.append("\n#FUN_10058950     \n")

		tmp = state.esp
		log.append(hex(state.esp))
		state.push(0xFF0F0000) #eflags
		state.push(0xFF1F0000) #eax
		state.push(0xFF2F0000) #ecx
		state.push(0xFF3F0000) #edx
		state.push(0xFF4F0000) #ebx
		state.push(tmp) #esp
		state.push(0xFF6F0000) #ebp
		state.push(0xFF7F0000) #esi
		state.push(0xFF8F0000) #edi
		
		state.AddRoute(0x444, 0x141be41 - 0x141b11e)
		log.append("#Jump to route {:02X}".format(0x141be41 - 0x141b11e))
	elif eip == 0xEA9:
		log.append("\n#CALL EDX     \n")

		tmp = state.esp
		log.append(hex(state.esp))
		state.push(0xFF0F0000) #eflags
		state.push(0xFF1F0000) #eax
		state.push(0xFF2F0000) #ecx
		state.push(0xFF3F0000) #edx
		state.push(0xFF4F0000) #ebx
		state.push(tmp) #esp
		state.push(0xFF6F0000) #ebp
		state.push(0xFF7F0000) #esi
		state.push(0xFF8F0000) #edi
		
		state.AddRoute(0x444, 0x141bfcf - 0x141b11e)
		log.append("#Jump to route {:02X}".format(0x141bfcf - 0x141b11e))
	else:
		log.append("\n\n#OnEnd {:02X}\n\n".format(eip))


state = TVM.VMState()
state.data = b'\x00\x00\x44\x04\x3d\x00\x51\x00\x12\x02\x3d\x00\x1f\xc6\x70\xff\xe1\xc3\x52\x79\x56\xbf\x8f\x35\x47\xdb\x52\x5e\x90\x00\xe6\x4d\x52\x00\xc4\x1a\x3d\x00\xaa\x00\x28\x00\x1c\xba\x3d\x00\x3d\x00\xbe\x6a\x98\xeb\x53\xb3\x00\x54\xd1\xa2\x90\x01\x4e\x9d\xe9\x00\x90\x00\x3d\x00\xf5\x04\x11\x00\x79\xf4\x41\x00\x76\x92\x0c\x51\x3d\x00\x3c\x93\x7a\x00\x4c\x0c\x3d\x00\x3d\x00\x6a\xd4\x4a\xc7\xe9\x5a\xb1\x5a\xa2\x68\x58\x5c\xa8\x7f\x99\x3f\x52\x00\x25\x70\x75\x00\x3d\x00\x73\xce\x08\x3d\x00\xde\x38\x75\x00\x52\x00\x5b\xba\x3d\x00\x1f\x0a\x4b\xad\xb0\x46\xc1\x63\x75\x00\x2b\x94\x6b\x0d\x28\x00\xd9\x22\x72\x0d\x75\x00\x28\x00\x25\xc0\x41\x00\x11\x00\x41\x00\x59\xea\x7a\x00\x63\xec\x00\x00\xe8\xa7\x5a\xb1\xee\x36\x6f\xfc\xb9\x7d\xea\x5c\x10\x75\x75\x00\x18\x7a\x11\x00\xdd\x74\x3d\x00\x1f\x16\xbd\x85\x3d\x00\x99\x19\xa5\x87\x1b\x93\x00\x22\x0f\x04\x41\xf5\x75\x00\x7a\x00\x26\xba\x3d\x00\x6a\x5e\xf1\x05\x75\x00\x89\x7f\x6b\x9a\x7a\x00\x70\xc1\x75\x00\x97\x76\xea\xc0\x90\x00\x11\x00\x21\x5a\x3d\x00\x14\xee\x29\x7d\x6b\x73\x7a\x00\x75\x00\x7c\xc7\x75\x00\x09\xaa\x41\x00\x28\x00\x22\xa3\x2f\x11\xaf\x82\x7a\x00\x7a\x00\xc5\x58\x3d\x00\x15\x7e\x3d\x00\xdc\x1f\x92\xd7\x6b\x8c\xf8\xc3\x75\x00\x6c\x7c\xfa\x6a\x11\x00\x1f\xfb\x3d\x00\x19\xe6\xe5\x24\x45\xd8\x81\x75\xfa\xfe\x8a\xef\x23\xc0\xb1\x26\xec\x7d\x28\x00\x75\x00\x37\xf1\x75\x00\x77\xa8\x41\x00\x28\x00\x3d\x00\x24\x84\xa6\x20\x02\xd1\x1c\xc0\x75\x00\x2f\x39\xc4\x6f\x11\x00\xfa\xfe\x6f\xed\x0d\x75\x7f\x91\x5a\xee\x2a\xe6\x82\x00\x0c\x74\x75\x00\x12\x9e\x28\x00\xfa\xd2\x53\x57\x52\xc4\x4e\xf3\xec\x2e\x81\x35\x18\x56\xb8\xee\x03\xd7\xb1\x22\x7d\x88\xd3\xb5\x9e\xa4\x00\x7b\xe6\x0e\x7d\xff\x11\x00\x3d\x00\x72\xca\x9e\x3e\x8b\x47\x74\x98\x46\x99\xf3\xee\x95\x75\x27\xf0\x75\x00\x52\x00\xc8\xba\x3d\x00\x5c\x61\x8e\x1d\x90\x00\x3e\xff\x41\x00\x3d\x00\xb2\x75\x7a\x00\x4b\xc6\x3d\x00\x05\x2f\x73\xd8\xb6\x25\x28\x00\x75\x00\xee\x80\x41\x00\x1b\x33\x3f\x08\xd3\x8a\x98\xd1\xce\x2a\x75\x00\x75\x00\x76\x89\x58\xd9\x6c\xef\x75\x00\x20\xe2\x11\x00\x12\x1c\x39\xef\x3d\x00\x3c\x00\x41\x00\x20\x96\x41\x00\xc3\x99\x28\x00\x51\x6b\xa1\x14\x75\x00\x90\x00\xda\x6c\x52\x00\x41\x00\x90\x00\x3a\xb6\x11\x00\x52\x00\x98\x59\x3d\x00\x3c\x33\x82\x94\x47\xab\x04\xa7\x8f\xba\x52\x00\x75\x00\x28\x00\x75\x00\x7a\x00\x52\x00\x41\x00\x41\x00\xd9\x1a\x90\x00\x7a\x00\x28\x00\x11\x00\x11\x00\x90\x00\x28\x00\x52\x00\x51\x00\x00\x00\xab\x00\x00\x00\x75\x00\xa2\x5c\x9f\xb5\x15\x6b\x06\x3d\x00\xee\x23\x11\x00\x8b\xd8\x23\xe5\x5f\x10\x75\x00\x06\x94\x8d\xfc\x52\x00\x75\x00\x4b\xf6\x75\x00\x57\xa6\x90\x00\x28\x00\x6e\x4b\x52\x00\x90\x88\x15\x67\x75\x00\x6b\xcb\x97\x49\xe5\x48\xb0\xd2\x75\x00\xdb\xc9\x39\x94\x52\x00\x46\xd6\x31\xcc\x28\x00\xf1\xdf\x75\x00\x28\x00\x75\x00\xf9\x49\x33\x35\xc7\xd9\xdb\x5f\xaf\xfb\x75\x00\x3d\x00\x70\x02\x28\x00\xad\x12\x41\x00\x7a\x00\x52\x00\x41\x00\x28\x00\x5f\x02\x90\x00\x41\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\x00\x00\x00\xab\x02\x00\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x82\x03\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\xed\x02\x28\x00\x7a\x00\xf9\xa7\x9e\x1f\x80\x6e\x75\x00\xd9\x58\x7a\x00\x52\x00\x41\x00\x41\x00\x29\x16\x90\x00\x7a\x00\x11\x00\x28\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\x00\x00\x00\xe5\x00\x00\x00\x75\x00\xa2\x28\x9c\x3e\x03\x90\x00\x3d\x00\xb0\xf0\xb6\x2b\xb1\xbc\x83\xf5\xef\xe1\x18\x76\x61\xc0\x75\x00\x05\xf4\x55\x7a\x28\x00\x55\xde\xe4\x41\x3d\x00\x11\x27\x77\x43\x75\x00\xd5\xfc\xdc\xe5\x52\x00\xa0\x8b\x0f\xa1\x0d\x85\x87\x3b\x6c\x01\x3f\x44\xb5\xea\x3d\x00\xf5\xac\x60\x48\x94\x67\xab\x39\x75\x00\xc7\x68\x3d\x00\xd8\xc9\x08\x88\x1f\x75\x74\x24\xbb\x60\xd4\x68\x4d\x7a\x21\x32\x7a\x00\xf9\xaf\xe4\x41\x3d\x00\x2d\x57\x7b\x20\x75\x00\x45\x8d\xca\x7d\x41\x00\x58\xc1\xe0\xd0\xbf\xde\x75\x00\x3d\x00\xee\xac\xba\xd7\x70\x2d\x52\x00\x75\x00\xf1\xe2\x31\x4d\x41\x00\x34\xdd\x3d\x00\xe0\x34\x94\x7c\x72\x9b\xef\xd9\x75\x00\x3d\x00\x3a\x54\x7a\x00\x52\x00\x41\x00\x41\x00\xde\x18\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\x00\x00\x00\x9c\x01\x00\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x03\x19\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x90\x01\x18\x01\x45\x1d\x11\x00\x26\xf4\x28\x00\x3d\x00\xcb\x30\xe1\x2e\x5d\xc0\x75\x00\x68\xaa\x8c\x49\x90\x00\xb1\x16\x58\xb3\x3d\x00\xa0\xb3\xf1\x38\x6d\xe0\x90\xc7\x6a\xdd\xd1\x0b\xf8\xbb\xf1\xa4\xf5\x81\xd7\xc3\x2e\x00\x48\x7d\xa9\x1e\xfe\x00\xe8\xac\x92\xcf\x3d\x0e\x95\xed\xbf\x55\x75\x00\x94\xc2\x59\x07\x81\x14\x6f\xe0\x41\x00\x08\x4d\x7a\x00\x90\x00\xfb\x3a\x11\x00\x80\x45\x75\x00\x75\x00\x5f\x17\x12\xc7\x12\x6a\x3f\x72\x57\x69\x11\xee\x85\x96\x5c\x67\x75\x00\xf8\x20\xa4\x94\xc8\x68\xfa\x98\x0e\xe1\x88\xa7\xd7\xe9\x08\xb0\xe9\x1e\x49\x6b\x20\xab\x1d\x77\x93\x07\xc8\x2c\xa4\xed\x87\xbd\xf7\x0c\x75\x00\x7c\xb0\xe3\x8b\xd7\xeb\x06\xbf\x48\x7f\x98\x44\x9b\x2c\x7a\x56\x4d\x2a\xb5\xf9\x30\x63\x28\xef\x98\xd5\x80\x82\x19\x24\x75\x00\x3e\xd8\x4b\xbc\x58\xe1\x11\x00\x75\x00\x7a\x00\x90\x51\x52\x00\x52\x00\xd4\x20\x11\x00\x97\xcc\x75\x00\x75\x00\x1a\x00\x27\x43\xa1\x5c\x13\x56\xee\x60\x23\xed\x22\xf3\xad\x72\x41\x00\x24\x9f\xad\xc6\xd7\xeb\x35\x13\x75\x00\xe0\x7e\x8c\x85\x3d\x00\x35\x8b\x7c\xaa\x75\x4a\xf8\x98\x70\x09\x6e\xf6\x0c\x44\x3d\x00\xfa\x28\x7e\x8b\xe3\xcb\x64\x14\xfd\x6c\x3d\x00\x89\x8f\x0c\xf9\x75\x00\xaa\xd4\x76\xf4\x52\x00\x5c\x8b\x2d\xae\xfd\xf8\x33\x1d\x28\x00\x75\x00\x28\x00\x75\x00\x5f\x5c\x11\x00\x41\x35\x75\x00\xd9\x00\x8e\x4d\x90\x00\x6e\xcd\x3d\x00\x96\x37\xcb\x7d\x46\x01\xb9\xfa\x75\x00\x5c\x9f\xca\x6c\xbc\x7e\x3d\x00\x9c\x02\x11\x00\xd3\x1a\x7a\x00\x3d\x00\x4c\xdc\x7a\x00\x52\x00\x41\x00\x90\x00\x11\x91\x90\x00\x7a\x00\x28\x00\x52\x00\x11\x00\x11\x00\x28\x00\x41\x00\x98\x01\x11\x00\xe0\x38\x7a\x00\x7a\x00\xc9\x0a\x28\x00\xf3\x37\x75\x00\x75\x00\x7b\x80\xf9\x28\xb4\xc5\x22\xf1\x6c\x7a\xfc\x1e\xe9\x5a\x91\x84\x09\xe3\x70\x9d\x61\xc0\x75\x00\x00\xb3\xd4\x77\x52\x00\x42\x02\xc7\x43\x3d\x00\xec\x38\x75\x00\x52\x00\xf3\xb8\x3d\x00\x5f\xad\x47\x0f\xb7\x55\xaf\xea\xab\x5d\x3c\x09\x52\x00\xee\x25\x90\x00\x52\x00\x46\x5f\x41\x00\x53\x64\x75\x00\x75\x00\x7a\x00\x28\x00\x0f\x5a\x3d\x00\x7a\x7e\x75\x00\x28\x00\x0c\xba\x59\x60\x78\x33\x75\x00\x3d\x00\x13\x74\x30\x2a\x1b\x45\x28\x00\x75\x00\x3e\x52\x6e\x8a\x75\x00\x3c\xe3\x58\x76\x35\x11\x28\x00\x75\x00\xd2\x69\x34\x3e\x3d\x00\x20\xb8\x7b\x41\x8f\xeb\x75\x00\x45\xfc\x92\x3b\xe7\x95\x3d\x00\x9c\x01\x7a\x00\xeb\xe7\x11\x00\x64\x16\xf5\xa9\x3d\x00\x73\x9b\xca\x7d\xa0\xc2\x75\x00\x75\xa0\x3b\x10\x28\x00\x40\x0e\x75\x00\x52\x00\xf3\xb8\x3d\x00\x31\x9a\x85\x4d\xc8\x70\x8c\x40\xde\xb1\xe7\xbb\xef\x2f\x08\x0e\x9f\x5a\xe3\x17\x00\x46\x05\x2b\xa1\x7b\x3f\x28\xdb\xed\xf1\xa1\xb0\x0c\x75\x00\x09\xd5\x7a\x00\x7b\x4a\xe5\x49\xcb\x33\x18\xd6\x75\x00\x3d\x00\x20\x6d\xe5\xf5\xe1\x80\xc5\x30\x44\x8f\xb9\x34\x3f\x37\x9d\x1e\x52\x00\xf0\x12\x35\x1d\x3d\x00\x36\x13\xc5\x8f\xf7\x8e\x9b\xa5\x7a\x00\x90\x00\x75\x00\x8c\xa7\x72\xa7\x39\xd0\xa6\x00\x75\x2c\x61\x52\x5d\x5e\xbf\xd4\x93\x4b\xe6\x10\x51\x71\xca\x84\x58\x50\x3d\x00\x65\x0d\x2b\x3d\xdb\x56\x28\x00\x75\x00\x75\x42\x10\x77\x6a\x2b\x41\x08\xbc\x16\x53\x91\x3d\x00\x8c\x1f\xd4\xe4\xd7\x08\x2d\xe4\x90\x5d\xb4\xa2\x98\xa3\xdc\x30\x7a\x6e\x40\xc1\x8c\x8a\x4e\x97\xf4\x17\x7b\xa6\x9d\xfc\x90\x00\x28\x00\x75\x00\xbb\x18\x55\x07\x31\xcc\x3d\x00\x9c\x02\x41\x00\x64\x63\x11\x00\x3d\x00\x0d\xab\x75\x00\xe3\xc4\xc0\x64\xbb\x23\xfb\xc2\xdb\xde\x61\x03\x49\x2c\x75\x00\x41\x00\xf3\xb8\x3d\x00\xed\x1d\x9e\x20\xdf\xe6\xe9\xf3\x68\xe1\x38\xed\x43\xe0\xce\x09\xf3\xc1\x7a\x00\x28\x00\xa6\x46\x0b\x52\x00\x75\x00\xd8\xc7\xe7\xe4\x52\x00\xd5\xfc\xaf\x02\x11\xf9\xa2\x33\x99\xef\xdc\x0a\x8c\x36\xad\x31\xf8\x34\x59\xeb\x64\xa8\x75\x00\x83\x92\x48\x81\x3d\x00\x63\x29\xc2\x8a\x52\x8c\x64\x6e\xbd\x95\x32\x5c\xf2\xd3\x55\x6c\x7a\x00\xb9\xe4\x50\x59\x41\x00\x52\x00\xdd\xd6\xae\xd3\x72\x6f\x66\x3f\x75\x00\xa4\x8d\xf1\xaa\x8a\xbf\x46\x81\x9f\x5e\xfb\xdf\x75\x00\x2a\x4c\x2c\x9b\x17\x49\x52\x00\x96\x77\x90\x00\x52\x00\xe7\x9a\x90\x00\x77\x36\x75\x00\x75\x00\x45\xa2\x6f\x25\xac\x7b\xd8\x70\xd7\x12\xba\xeb\x0a\x6d\xe4\x98\x3d\x00\x1d\x15\x04\x3a\x14\x18\x28\x00\x75\x00\x1a\x03\x75\x00\x83\x08\xa5\x7b\xfc\xf0\x59\xff\x28\x00\x15\x5f\x90\x00\x11\x00\xba\x1e\x28\x00\x36\x48\x41\x00\xbc\x16\xfc\xc9\x3d\x00\x5a\xe5\x42\x25\xd4\x32\x0e\x0f\xc3\x60\xbb\xd0\x55\x7e\x57\x79\x66\x1f\x41\x0d\xc3\x5d\xaa\x96\x58\x38\x60\xa6\x8c\x30\x90\x00\x41\x00\x75\x00\xd7\x39\xea\xf9\x34\xee\x3d\x00\x80\x05\x04\x49\xd9\xcf\x51\x7f\x16\x0c\xb3\x5a\x94\xc0\x5d\x22\x7a\x00\x3d\x00\x60\xb7\x90\x00\x27\xd0\xda\x8d\x11\x00\x5e\x72\x75\x00\x41\x00\x75\x00\x0d\xb1\x75\x00\xa4\x8f\xea\x45\x71\x7f\x1f\x35\xe0\x6d\xe8\x02\xdd\x9d\x90\x00\x3d\x00\x97\xa8\x8a\x5a\x6e\x85\xbf\x7a\xea\x02\x3d\xef\xe9\x56\x74\xf4\x02\x20\xd3\x3f\x5a\x35\x84\x01\xb5\x1e\x1d\x4a\x6f\x48\x75\x00\xbc\xf8\x75\x00\x41\x00\x39\x8b\x13\x3d\x00\x60\xa3\xeb\x79\x31\x08\x36\xaf\xd7\xec\xe0\x1e\x25\x75\x00\x3d\x00\x9e\x53\x75\x00\x41\x29\x28\x00\x53\x12\xcf\x67\x02\x94\x75\xf7\x01\x10\x62\x95\xd5\x7a\xf9\xef\xe4\xfa\xaf\xfb\x0a\x07\x75\x00\xd2\x0b\x2e\x91\xc8\x07\x6a\xfc\x7a\x00\x52\x00\x41\x00\x90\x00\x86\xd2\x90\x00\x52\x00\x28\x00\x7a\x00\x11\x00\x11\x00\x28\x00\x41\x00\x51\x00\x00\x00\x1b\x01\x00\x00\x75\x00\x80\x6c\x7f\xca\x21\xb4\x23\xd1\x81\x75\x00\xc6\x4f\x41\xf7\x06\x97\x4f\x82\xa9\x3a\xb0\x0b\x03\xa6\xad\x78\xfa\xed\x4d\xd3\x89\xb4\xd2\x09\xf0\x33\x52\x00\x41\x00\xcc\x8e\x41\x00\xf4\x26\x90\x00\x67\x18\xb9\xb3\x75\x00\x48\x0b\x64\x14\x09\xd8\x3d\x00\xac\x8e\x5d\x34\x75\x00\x41\x14\xc5\x54\x41\x00\x75\x00\x41\x00\x9b\xd8\xf7\xb4\x72\x21\x75\x00\xc5\x54\x7a\x00\xac\xa4\x3d\x00\x9e\x31\x2b\x0e\x75\x00\xd6\x55\x75\x00\x11\x00\x04\x6b\xba\xd3\x7a\x00\x4c\x25\x41\x00\x3d\x00\x48\x47\xb1\xaa\x59\xc0\x75\x00\xb3\x7f\x79\x79\x90\x00\x7a\x00\xc3\xc3\x90\x00\x11\x00\x31\x35\x90\x00\x31\xd4\x75\x00\x75\x00\x5c\x84\xd4\x09\xd0\x45\xd9\xe5\x59\x3a\xe7\x57\xea\x8f\xb8\x2b\x89\xfd\xf1\x50\xf0\x67\xf0\xb3\x2d\x20\xdd\x35\x29\xdf\x2f\x43\xff\x65\xdb\xa8\x93\x41\x00\x2c\x6c\x21\x1e\x19\x75\x00\x26\xb7\xd1\x22\x28\x00\x75\x00\x52\x00\x90\x00\x00\x27\x10\x16\x75\x00\xf8\x66\x28\x00\x21\x6b\x25\x6b\x3d\x00\x7b\x48\x0b\x23\x5d\xec\x74\x14\x6c\xc1\x9d\x5a\x45\x91\x0e\x52\x28\x00\x3d\x00\xb0\x81\x7a\x00\x52\x00\x41\x00\x52\x00\xb5\x36\x90\x00\x28\x00\x7a\x00\x41\x00\x11\x00\x90\x00\x28\x00\x11\x00\x14\x00\x83\xd2\x3d\x00\x8b\x00\xd1\x67\x1d\x14\x73\x8b\x7e\x5d\x59\x9d\x00\xbf\xb0\x28\x75\x00\x87\x67\x6e\x50\xa4\x7e\x98\xe4\x9b\xe1\x9c\x02\x3d\x00\x2c\x55\x75\x00\x03\x1f\x93\x3c\xcc\x80\x58\xd7\x02\x03\x9c\x02\x3d\x00\x87\x56\x35\x8b\xcb\xc9\x01\x60\x7c\x52\xcc\x48\xf6\xf6\x42\x41\x3d\x00\x2a\xfe\x96\xe5\x24\xb4\x75\x00\x07\x61\x03\x47\xfc\x5b\x9f\x59\xd3\x79\x9b\x00\x95\xdd\x31\x7d\x40\x9e\x3c\x3f\x90\x00\x52\x00\x75\x00\x40\xdd\x95\x07\xd2\xbe\xa0\x77\x57\x4a\x61\x20\x3d\x00\xfa\xdf\x17\x45\x3d\x00\x16\xa2\x07\x6b\xa0\x77\x52\x00\x9e\x86\x41\x00\x7a\x00\x18\x15\x41\x00\x17\x5b\x90\x00\x05\x32\xc9\xd6\x39\x58\xea\x33\x28\x00\x90\x00\x75\x00\x3d\x00\x20\x2a\x7a\x00\xf8\x96\x29\x4a\x28\x00\xa3\xcc\x75\x00\x52\x00\x75\x00\xbb\xbd\x3d\x00\xce\x45\xb2\xfb\x93\x50\x75\x00\x89\x3b\x41\x00\xdf\x3b\xb8\x55\x75\x00\x01\xdf\x43\x00\x11\x00\x58\x76\x62\xb9\x75\x00\x3c\x44\x75\x00\x41\x00\x11\x00\x09\x6b\x52\x00\x90\x00\x7e\x95\x41\x00\xd3\xa6\x75\x00\x75\x00\xd9\xcb\x80\x75\x20\x45\x97\x0c\x68\x86\x03\x5d\x78\x5f\x63\xdd\xb9\x95\xec\x44\x2a\xda\x25\xe6\x5c\x80\x2a\x3d\x00\xf1\xde\x07\xba\x42\x3e\x77\x38\x28\x52\x6f\x3a\xd1\xe5\x36\xb0\xd2\x49\xac\xaa\xcc\x86\x14\x5a\x28\x3d\x00\x6c\x17\xd0\x6e\x3d\x00\xdb\xdc\x75\x00\x90\x00\x3d\x00\x75\x00\x46\x3c\x06\x42\x3d\x00\xdc\xfb\xc7\x43\x3d\x00\x15\x38\x75\x00\x52\x00\xc4\xba\x3d\x00\x86\x14\xcc\x49\x3d\x00\x86\x14\xf9\x6a\x3d\x00\xba\x14\x20\x94\x3d\x00\x8b\x65\xd6\x42\x3d\x00\x7a\x00\x52\x00\x41\x00\x52\x00\x07\x7d\x90\x00\x11\x00\x90\x00\x28\x00\x11\x00\x7a\x00\x28\x00\x41\x00\x9e\x63\xc2\xc0\x41\x01\x20\x00\x50\x89\x05\x00\x3d\x00\x51\x00\xf5\x04\x6f\x6d\x63\x23\x3d\x00\x3d\x00\xd6\x84\xc7\xaf\x58\x9c\xeb\x04\xf2\x52\x6c\x2a\x55\x0a\xa2\x33\x28\x00\x3d\x00\x12\x02\x90\x00\xd9\xc3\x52\x00\x3d\x00\x12\x84\xc6\x20\x7e\xd2\x6d\x59\x1c\x0b\xbd\x75\x6c\xf0\xbf\x0d\x11\x00\x3d\x00\x3c\x03\x28\x00\xce\x20\x41\x00\xad\xff\x28\x00\x8f\x0e\x3d\x00\x2d\x40\x52\x6d\x3d\x00\x3d\x00\xd7\x02\x7a\x00\xd5\x7f\x7a\x00\xd5\xc9\x75\x00\x7a\x00\x3d\x00\x11\xb9\x08\x3d\x00\x90\x00\x75\x00\xa7\xfd\x90\x00\x37\xd9\x3c\x0b\x7a\x00\x52\x00\x41\x00\x28\x00\xb7\xcb\x90\x00\x41\x00\x11\x00\x7a\x00\x11\x00\x90\x00\x28\x00\x52\x00\x51\x00\x00\x00\x61\x00\x00\x00\x75\x00\x04\x89\xd7\xb9\x3a\x4b\xd1\x75\x00\xf7\x82\x35\x9b\x41\x00\x22\x09\x7a\x00\xc2\x08\x58\xab\x27\x00\x75\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x8e\xf2\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\x00\x00\x00\x56\x00\x00\x00\x7a\x00\x52\x00\x41\x00\x41\x00\xd4\xf6\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\xab\x03\xf2\xcc\x73\x40\x68\xfe\x91\x73\x22\xde\x1d\xe9\xba\x12\x31\x4b\x75\x00\xb0\x25\x90\x83\x7a\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x5c\xd1\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x9c\x01\x7b\x16\xd3\x63\x3d\x00\xfd\x5b\x75\x00\x7a\x00\x2e\xb9\x3d\x00\xdb\xdc\x75\x00\x28\x00\x3d\x00\x75\x00\x4f\xd5\xc7\x43\x3d\x00\x7e\x38\x75\x00\x52\x00\xc4\xba\x3d\x00\xba\x14\x7f\x8e\x3d\x00\x32\xb5\x06\x42\x3d\x00\xa1\x73\xc7\x43\x3d\x00\xc7\x38\x75\x00\x41\x00\x39\xb8\x3d\x00\xe8\x00\x75\x00\x11\x00\x28\xb9\x3d\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x31\x8f\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x14\x92\xd1\xc0\x41\x01\x20\x00\x50\x89\x05\x00\x3d\x00\x51\x00\xac\x02\x41\x00\x7a\x00\x1e\x5b\x3d\x00\x34\xfb\x33\xb4\xaa\xd7\x3d\x00\x3d\x00\x4f\xb4\x85\xac\xdd\xdb\xff\x1e\xb5\x0f\x37\x0d\x95\x3f\x1b\x01\x90\x00\xe2\xde\xcd\x45\x3d\x00\x7a\x00\x7a\x00\xd5\x58\x3d\x00\x12\x67\x11\x00\x7a\x00\xf8\x57\x3d\x00\xa3\xd9\x3d\x00\xf5\x04\x7a\x00\xe4\x4a\x52\x00\x1b\xfc\x23\x48\x3d\x00\xd0\xcd\x75\x00\x7a\x00\x3d\x00\x23\xbd\x08\x3d\x00\x52\x00\x80\x5e\x28\x00\x52\x00\x07\x60\x11\x00\x79\x68\x75\x00\x75\x00\x8b\xf7\x40\x75\x00\xfb\xfc\xc3\x75\x18\x3b\x28\x00\x38\x7e\x90\xd5\xde\x46\xdf\x1f\x8c\x7c\x83\x7e\x76\xf0\x7a\x2f\xbb\x6f\xfd\x62\x81\x13\x14\x15\xad\xdd\x71\x5c\xa8\x37\xb8\x79\x8e\xa4\xd4\x42\x49\x9b\xe9\x0f\xb2\xec\x89\xf8\x0b\x10\x8a\x38\x4d\x4d\x4c\xc2\x52\x00\x2f\xa8\x28\x00\x7a\x00\x4c\xc2\x11\x00\xb2\x2f\x7a\x00\x4a\x34\x07\x75\x6c\x6e\x52\xf6\x54\x20\xad\xf7\x4d\x51\x4a\x58\xcd\x0f\x00\x08\xb7\x75\x90\x89\x26\x64\x0b\xf3\x12\xe0\x5b\x39\x3e\x8f\xf6\x84\xe0\xe7\x62\x77\x32\x20\x52\x5d\x14\x0a\x10\x1d\x04\x06\x94\x5b\x75\x3d\x83\xbf\xaa\x2b\x75\x00\x47\x9c\x11\x00\xdd\xbf\xb3\x3b\x6d\x38\x75\x00\x28\x00\x39\xb8\x3d\x00\x00\x00\x75\x00\x52\x00\x39\xb8\x3d\x00\x00\x00\x75\x00\x52\x00\x2e\xb9\x3d\x00\x9c\xde\x75\x00\x90\x00\x3d\x00\x75\x00\x00\x00\x75\x00\x11\x00\x39\xb8\x3d\x00\xd2\x00\x75\x00\x90\x00\xc4\xba\x3d\x00\xba\x14\x6c\xac\x3d\x00\x7c\xb5\x06\x42\x3d\x00\xb9\x73\xc7\x43\x3d\x00\xed\x38\x75\x00\x52\x00\x39\xb8\x3d\x00\xc2\x00\x75\x00\x41\x00\x28\xb9\x3d\x00\x7a\x00\x52\x00\x41\x00\x11\x00\xcf\x88\x90\x00\x52\x00\x28\x00\x41\x00\x11\x00\x7a\x00\x28\x00\x90\x00\xc2\x97\xe0\xc0\x41\x01\x20\x00\x41\x00\x3d\x00\x51\x00\xcf\x01\x3d\x00\x3c\x03\x41\x00\x0f\x4d\x7a\x00\x87\xff\x52\x00\xca\x6c\x3d\x00\x3d\x00\x12\x02\x90\x00\xde\xca\x90\x00\x3d\x00\x9f\xb5\xa2\xe2\x1e\x7c\x27\x2d\xf0\xfb\xa2\x3b\xe5\x44\x09\x0e\x28\x00\x3d\x00\xf5\x04\x11\x00\x5f\xa2\x52\x00\x8c\x79\x55\xf5\x3d\x00\xba\x7c\x14\xf6\x3d\x00\x3d\x00\x71\x0a\x31\x5e\x86\x1e\x9d\x1e\xf5\xed\xa5\x01\x7b\x9a\x94\x44\x7a\x00\x3c\xaa\x75\x00\x3d\x00\x81\x14\x08\x3d\x00\x75\x00\xcd\x8b\x52\x00\x39\xab\x12\x71\x7a\x1c\x6b\x0e\xf2\xde\x87\xf4\x38\xa7\x11\x34\x80\x03\x89\x9e\xb0\xd2\xf4\xba\x91\x3e\x6c\x17\x65\x9a\x3d\x00\xd7\xdc\x75\x00\x28\x00\x3d\x00\x75\x00\xba\x14\x5b\xc9\x3d\x00\xca\x2c\xc7\x43\x3d\x00\x86\x38\x75\x00\x90\x00\xc4\xba\x3d\x00\x7b\x16\xad\xfe\x3d\x00\x9c\x5c\x75\x00\x41\x00\x39\xb8\x3d\x00\xda\x00\x75\x00\x52\x00\xf8\xba\x3d\x00\x47\xf6\xd6\x42\x3d\x00\x7a\x00\x52\x00\x41\x00\x7a\x00\x4b\xa1\x90\x00\x28\x00\x52\x00\x41\x00\x11\x00\x11\x00\x28\x00\x90\x00\x39\xbc\x01\x53\x59\x00\x20\x00\x68\xa1\xbc\x41\x01'

state.esp = 0x6F8A8
state.VMA = 0x10f0429c ##Where VM registers in mem
TVM.VMA = 0x10f0429c

state.push(0x12345678)
state.push(0x257)

tmp = state.esp

state.push(0xFF0F0000) #eflags
state.push(0xFF1F0000) #eax
state.push(0xFF2F0000) #ecx
state.push(0xFF3F0000) #edx
state.push(0xFF4F0000) #ebx
state.push(tmp) #esp
state.push(0xFF6F0000) #ebp
state.push(0xFF7F0000) #esi
state.push(0xFF8F0000) #edi

state.reg4[TVM.R_EIP] = 0
state.reg4[TVM.R_31] = 0xFCB2A014
state.reg4[TVM.R_ImgBase] = 0x10000000 #imgBase


state.wMem(0x000A2EC0, b'\x0A\xB2\xAC\x0A')


state.wMem(0x10EFD721, b'\x4e\x67\x9b\xb8')
state.wMem(0x1103f789, b'\x08\x10\x43\x11') #0x11431008
state.wMem(0x11431008, b'\x0A\xB2\xAC\x0A')

state.wMem(0x11062511, b'\x0C\xFD\x6D\x1F')
state.wMem(0x110B727D, b'\x69\x7A\xB8\xED')
state.wMem(0x1105915F, b'\x59\x89\xC1\x58')
state.wMem(0x1109D8BB, b'\x7F\xA5\xEC\x70')
state.wMem(0x110AA61B, b'\x10\xBF\xEE\x94')
state.wMem(0x110BCE23, b'\x73\x58\x01\xF3')



state.wMem(0x7D0B736F, b'\xFF\xFF\xF7\xFF')
state.wMem(0x7C80003C, b'\x0F\x00\x00\x00')
state.wMem(0x7C800117, b'\x00\x3E\xB6\x00')

##7C800000 - kernel32

state.AddRoute(0x257, 0)

state.OnEnd = FNC
#state.AddRoute(0x444, 0, False)

PARSED, ERR = TVM.Parse(state)
for k,v in sorted(PARSED.items()):
	for l in v:
		print(l)
		pass
	print()


for l in ERR:
	print(l)
	pass

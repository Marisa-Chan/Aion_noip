#!/usr/bin/python3

#10594df6

import sys
import TVM

def FNC(state, log):
	eip = state.reg4[TVM.R_EIP]
	if eip == 0xBE6:
		log.append("\n#memset     \n")

		tmp = state.esp
		log.append(hex(state.esp))
		state.push(0xFF0F0000) #eflags
		state.push(0xFF1F0000) #eax
		state.push(0xFF2F0000) #ecx
		state.push(0xFF3F0000) #edx
		state.push(0xFF4F0000) #ebx
		state.push(tmp) #esp
		state.push(0xFF6F0000) #ebp
		state.push(0xFF7F0000) #esi
		state.push(0xFF8F0000) #edi
		
		state.AddRoute(0x444, 0x14164f8 - 0x1415908)
		log.append("#Jump to route {:02X}".format(0x14164f8 - 0x1415908))
	elif eip == 0xD45:
		log.append("\n#FUN_100b0780     \n")

		tmp = state.esp
		log.append(hex(state.esp))
		state.push(0xFF0F0000) #eflags
		state.push(0xFF1F0000) #eax
		state.push(0xFF2F0000) #ecx
		state.push(0xFF3F0000) #edx
		state.push(0xFF4F0000) #ebx
		state.push(tmp) #esp
		state.push(0xFF6F0000) #ebp
		state.push(0xFF7F0000) #esi
		state.push(0xFF8F0000) #edi
		
		state.AddRoute(0x444, 0x1416657 - 0x1415908)
		log.append("#Jump to route {:02X}".format(0x1416657 - 0x1415908))
	else:
		log.append("\n\n#OnEnd {:02X}\n\n".format(eip))


state = TVM.VMState()
state.data = b'\x00\x00\x44\x04\x3d\x00\x51\x00\xcf\x01\x3d\x00\xcf\x01\x41\x00\x0f\x4d\x7a\x00\x3d\x00\x3c\x03\x28\x00\x94\x9d\x28\x00\x55\xff\x28\x00\x66\x6b\x3d\x00\x3d\x00\x38\xfd\x4b\xed\xfd\xe4\xe4\x3e\xd0\x5d\xdd\x7e\x10\x23\x19\x28\x7a\x00\x28\x00\x41\x00\x1e\x5b\x3d\x00\x40\xc0\x85\x53\x42\x3e\x3d\x00\x3d\x00\xf5\x04\x52\x00\x37\x02\x11\x00\x71\x09\x7a\xa3\x3d\x00\x39\x28\x75\x00\x11\x00\x3d\x00\xce\x58\x08\x3d\x00\x73\x14\x94\x0a\x3d\x00\x90\x00\x75\x00\x6b\x94\x52\x00\x8b\x33\x02\xa3\x75\x00\x9f\x7a\x00\x54\x0e\x41\x00\x50\x6b\x8a\xd2\x39\x42\x3d\x00\x6e\x9d\x26\x56\xe6\x42\x43\xa1\x75\x00\xd9\x1c\x75\x00\x05\x7d\x63\x52\xac\xf1\x48\x96\xf0\x74\xb6\x3b\x24\x1e\xf4\x62\x75\x00\x13\x6a\xbf\x6b\xbf\x9d\x11\x00\xbc\xbb\x3d\x00\xed\xde\x75\x00\x28\x00\x3d\x00\x75\x00\x7c\xca\xa4\x68\xe6\x7a\xd9\x2b\x09\xdf\x0b\x01\x75\x00\x7a\x00\x3d\x00\x3d\x00\xa0\x01\x28\x00\x11\x29\x41\x00\xd6\x00\x62\x43\x3d\x00\x75\x00\x3c\xf8\x41\x00\x04\x9c\x31\x06\x7c\x0d\x91\x79\xac\x76\x0f\x5f\x4a\x2f\x7d\xeb\x51\x37\x33\x18\x28\x00\x88\x5a\x11\x00\xb3\x14\x7d\xa3\x75\x00\x67\x72\xbb\xad\x05\x93\xd9\x8f\x6d\x1b\x69\x4e\x3d\x00\x3d\x00\xcf\x0a\x73\x4f\xcf\x0a\x1c\xc0\x75\x00\x67\xb5\x06\x49\x41\x00\x87\xaa\xf3\xee\xa3\x3b\x27\xf0\x75\x00\x28\x00\xc0\xba\x3d\x00\x52\x00\xd1\xec\x28\x00\x28\x00\xb3\x16\x11\x00\x87\xab\x75\x00\x75\x00\x75\xb8\xef\x54\x3d\x9e\x2f\x48\x28\x00\x7a\x00\x75\x00\x52\x00\xaa\x99\x7a\x00\xa5\xbd\xce\x00\x75\x00\x3c\x51\x6e\xb7\x00\x34\x60\x05\x09\x88\x59\x56\xbf\x1b\x11\x9d\xa6\x2f\x3d\x00\x0c\x61\xf3\x6f\xcb\xed\xa4\x99\xfc\xd1\x3d\x00\x50\xa7\xc6\x08\x09\x49\x1e\x59\xb1\xa6\xf3\x04\x09\xc3\x75\x00\xf7\x88\x31\x2e\x11\x00\x82\x00\x59\x93\x9d\x14\x0a\xff\x5a\x62\x1b\x34\x2b\x03\x24\xfb\x4f\x9a\xe0\x7d\xbe\x45\xca\xc0\x81\x3f\x0b\xd2\x38\xf2\x2a\x53\xe6\x17\x0f\x3a\x3d\x00\x75\x00\x19\x90\x52\x00\x94\x9d\x98\x39\x65\x00\xb9\x4c\xad\xc5\x73\xce\xa1\x88\x6e\x25\x96\x2a\xa2\x34\xed\x75\x17\x55\x72\x7f\x75\x00\x25\x7b\xe2\xeb\xee\x80\xeb\xc3\x60\x0b\xa4\xa2\x3d\x00\xc1\xed\x52\x9a\xf4\x38\xa7\x7e\x6c\x44\x99\x44\x64\xf7\x8b\x00\x52\x00\x3d\x00\x3b\xde\x61\x9d\x3d\xef\xf9\x2c\x41\x5f\x2e\x76\x3e\x76\x84\x7f\x0e\x56\xe8\x5f\x56\x15\x28\x00\xf9\x54\x5b\x7c\x75\x00\x41\x00\xfd\xcf\x90\x00\x52\x00\x90\x00\x47\x4a\x95\xcd\xee\xae\x3d\x00\x11\x00\x41\x00\xb6\xc6\x32\xd0\x53\xa0\x75\x00\x99\xd6\x7a\x00\x52\x00\x41\x00\x41\x00\xf0\x9f\x90\x00\x11\x00\x28\x00\x90\x00\x11\x00\x7a\x00\x28\x00\x52\x00\x51\x00\x00\x00\xaf\x00\x00\x00\x75\x00\xa2\x20\x83\x45\x87\x94\x6f\x11\x00\xcf\x2b\x90\x00\x3d\x00\xf8\x6c\xc7\xc4\x6a\xc2\x75\x00\x83\xcd\x09\x7e\x90\x00\x51\xfa\x89\x76\xfa\x1a\x40\xbd\xb5\xdb\x15\x0a\x7a\x00\x55\x4f\x13\x06\x7a\x00\x67\x30\x75\x00\x28\x00\x75\x00\xce\xa5\xe9\x93\x8b\x55\x41\x00\x28\x00\xb6\x02\x14\xe1\x11\x00\x25\xfb\x75\xb2\x75\x00\x78\xc0\x27\x5d\x9e\x6d\x3d\x00\x34\x66\x5e\x21\x0b\x35\x66\x33\x8b\x06\x71\x54\xb7\xe4\xba\x1a\x90\x00\x7a\x00\x52\x00\x41\x00\x28\x00\x57\x18\x90\x00\x41\x00\x90\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x11\x00\x51\x00\x00\x00\xdb\x02\x00\x00\x7a\x00\x52\x00\x41\x00\x41\x00\xae\x18\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\xed\x02\x90\x00\x90\x00\xfa\xa7\x9e\x1f\xb9\x6e\x75\x00\xf9\x58\x7a\x00\x52\x00\x41\x00\x41\x00\xae\x17\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\x00\x00\x00\xaf\x01\x00\x00\x75\x00\xa2\xb4\x7d\x61\x7b\x11\x44\x3d\x00\x15\xdd\xf8\x71\xb5\x64\xed\x89\xc3\x7d\xf8\x09\x87\x01\x52\x00\x75\x00\xc3\xb5\xaa\xc2\x8f\xca\x0b\xe9\x3f\x90\x00\x75\x00\xff\xc1\x93\x9b\xbe\x3c\x90\x00\x75\x00\x23\x61\x75\x00\xae\xa7\x28\x00\x90\x00\x60\x77\x59\x83\x44\x94\x86\xdf\x75\x00\x9e\x6b\x96\x03\x64\x14\x0e\x8e\x3d\x00\xe9\xa4\x36\x23\x75\x00\x4a\xc0\x5e\x87\x90\x00\x17\x92\x2a\xf3\x52\x00\x90\x00\x0f\x5f\x83\x3b\x40\x2c\x83\x6b\xae\x11\x00\x75\x00\xf3\x88\x05\xdf\x41\x00\x11\x00\x75\x00\x93\xc7\x93\x85\x75\x00\x37\x01\x11\x44\x3d\x00\xfc\x2c\xed\x25\x36\xcc\x07\x79\xc2\xbe\xcc\x08\x39\x92\x7a\x00\x71\x51\xac\x63\x75\x00\x11\x00\x48\x6d\x41\x00\x90\x00\x52\x00\x61\x0b\x3d\x00\x20\x04\x28\x00\x98\x35\x52\x00\xba\x59\x75\x00\x28\x6c\xcf\x23\xbe\xbd\x67\xb5\x5b\x6e\x10\x8f\x45\xf8\x75\x00\x6d\x23\x07\xaf\xa4\x69\x8c\x4f\x75\x00\x46\x97\x3d\x00\xa9\xea\xc9\x4e\x7d\xb4\x1f\x60\x92\x5f\xcd\x43\x9c\x61\x89\x44\x90\x00\x7e\x01\x41\xce\x28\x3b\x47\xd6\x75\x00\xec\x50\x7f\x0a\x52\x00\x6b\xbd\x3d\x00\xa1\x75\x75\x00\x52\x00\xf8\xba\x3d\x00\x36\x5d\xe4\x41\x3d\x00\xb3\x80\x2d\xf6\x75\x00\xe8\x7d\x1b\x00\x52\x00\x41\x00\xc4\x90\x28\x00\x52\x00\xa3\xcd\x41\x00\x3e\x91\x75\x00\x75\x00\x6f\x74\x90\x00\x20\xbc\x3d\x00\x75\x00\x33\xf2\xfb\x55\xef\xd2\xe2\x82\x10\x39\x88\x01\x82\xab\x8b\xfc\x16\xac\x75\x00\x90\x00\x2a\xd8\x41\x00\xee\x9d\x7d\xda\x75\x00\xae\xde\x3d\x00\x22\x54\x31\xe1\x96\x98\x1d\x60\x23\xdd\x49\x4e\x56\x99\xdf\x73\x7a\x00\x7a\x00\x52\x00\x41\x00\x52\x00\xf2\x2c\x90\x00\x90\x00\x11\x00\x28\x00\x11\x00\x41\x00\x28\x00\x7a\x00\x51\x00\x00\x00\x02\x01\x00\x00\x7a\x00\x52\x00\x41\x00\x41\x00\xa8\x28\x90\x00\x28\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x39\x02\xe8\xf9\x3d\x00\xb0\xea\x59\x7f\x61\x42\x05\x32\xea\xc4\xb5\xb4\x61\xc0\x75\x00\x57\x81\x18\x5b\x41\x00\x3b\xec\x11\x44\x3d\x00\x37\x1f\x4f\x58\xa2\x01\x6c\x04\xbb\x44\x04\xe8\x87\x4c\xc8\xef\xe1\x36\xb4\xaf\x5d\x3a\x7d\xf0\xae\x11\xb8\xd0\x00\x6b\xe4\x4f\xb3\xc7\x75\x00\xf1\xf9\x20\xd4\xfb\x5a\x26\x77\xa4\xb5\x57\x24\x1f\x16\x36\x4b\x3d\x00\x46\x89\x6c\x99\x2f\x7d\xc3\x47\xfa\x69\x4f\x24\x55\xc1\xef\x52\x75\x18\x52\x00\x28\x00\x75\x00\x00\x00\xde\x60\x3c\xc1\x1f\x22\x90\x00\x90\x00\x75\x00\xa4\xca\x93\x4b\x40\x8f\x1f\x8d\x02\x4f\x3d\x00\x3d\x00\xbc\x01\x49\xd5\x3d\x00\x93\xde\x14\x87\x33\x66\x04\x77\xa8\x24\x1d\x18\x75\x00\xbe\x94\xec\x24\x84\xf7\xd3\xe2\x6e\x08\x9c\x02\x3d\x00\xe2\x2b\x52\x00\x0d\x96\x51\x32\x52\x00\x1a\xad\x75\x00\x52\x00\x75\x00\x6e\x66\x3d\x00\x43\x28\x7a\x00\x52\x00\x41\x00\x41\x00\x1a\xcd\x90\x00\x52\x00\x11\x00\x7a\x00\x11\x00\x28\x00\x28\x00\x90\x00\x98\x01\x7a\x00\xe0\x38\x11\x00\x41\x00\x8b\x0a\x41\x00\xf3\x37\x75\x00\x75\x00\xd7\xd2\x76\xfb\xd5\x60\x51\x70\x5c\x38\x4c\xed\x9d\x8c\x67\x41\x8a\x23\x22\xed\x1d\xa5\xcb\x9e\x57\xaa\x11\x00\x52\xf9\x52\x00\x3d\x00\xab\x0b\x31\x9a\x8a\xc1\x75\x00\x73\x99\xa3\x74\x11\x00\x3d\x00\x66\x52\x55\xf6\x8d\x4a\x90\x00\x75\x00\x38\xc2\x22\x4d\x52\x00\x63\xbd\x3d\x00\xc6\x15\x79\x16\x3d\x00\xb5\xe5\x0a\xfe\x40\xfb\xaf\x64\x14\x33\x6c\x09\x74\xfa\xfe\x24\x30\xee\x89\x03\x1a\x58\x7a\x00\xbc\x3d\xc5\x8d\x41\x00\x91\x7f\x75\x00\x11\x00\x75\x00\xdd\xec\x54\x19\x32\xb0\xda\xf7\x3d\x00\x9c\x02\x11\x00\x1e\x3b\x11\x00\x3d\x00\xba\x5f\x75\x00\xd4\x62\x52\x00\xcc\x51\xba\x1f\x4b\xfc\x9d\x73\x5c\x51\xb7\x2d\x14\x02\x37\xf0\xd3\x4a\x34\xce\x41\x00\x02\xf3\x41\x00\x11\x00\x73\xf8\x7a\x00\x8f\x71\x11\x00\x95\xf2\xbb\x33\x2e\xe8\x95\x61\x11\x40\x5e\x06\x39\x52\x30\xb2\xbf\x17\x89\xdd\x14\xbf\x35\x8b\xc1\xca\x93\xdb\x65\x88\x4f\x1d\x60\xf7\x15\x41\x3d\x00\xeb\xfd\x7a\x00\xd4\x7e\x73\x50\x10\x15\x75\x00\xf2\x2e\x32\x6a\x4e\x58\x75\x00\x3d\x00\x17\xf3\x21\x61\x37\xd4\xc8\x0a\x9d\x1a\x5a\x58\xcb\x8c\xd8\x29\x28\x00\x7f\x93\xa7\x7c\x13\x0e\x75\x00\x10\xcc\xe4\x41\x3d\x00\xc5\x0a\x03\x14\x75\x00\xeb\xe6\x01\xfe\x11\x00\x52\x00\x90\x00\x0b\x9c\xde\x2c\xe2\x75\x00\xc0\x02\x28\x00\x75\x00\x6e\x8b\x6b\x76\x03\x28\x00\x75\x00\xe6\xab\xcc\x43\x4f\x6f\x45\x40\x43\x16\xd3\xf9\x6b\x7b\xef\x8d\xf8\x62\xe3\x9f\x7a\x7a\x00\x90\x00\x41\x00\xf0\xd3\xa3\x32\x00\xea\xdc\x39\xd5\x0d\x49\xad\x69\x1f\x32\xee\x47\xea\x6f\x1f\xa5\x1a\x35\x7f\x5e\xc9\x75\x00\x76\x77\xed\x0a\x41\x00\xca\xb9\x3d\x00\x41\x9b\x17\xfa\x28\x00\xc4\x33\x28\x00\x3d\x00\x55\x86\x6f\xed\x87\x3c\xc0\x01\x3d\xef\x48\x32\x99\xfe\x85\x42\xb3\xda\xa1\x07\xd1\xee\x51\x08\xd7\x4b\xd0\x75\x00\xfa\xea\x5c\xc8\xf0\x9d\xd8\x5d\x87\x9d\x62\x51\xd5\xed\x6f\xbf\x9d\x88\xeb\x70\x7a\x00\x28\x00\x43\x24\x75\x00\x75\x00\xf1\x1c\x04\x57\xa9\x82\x3f\x3b\xf8\xfb\x19\x02\xd3\x98\xa5\xb0\x75\x00\xbd\xe0\x75\x00\x7a\x00\x3d\x00\xc6\x17\x49\x72\x00\x72\x43\x7e\x7f\x2c\x1d\x3e\xf6\xef\xfd\x0e\x90\x00\xfa\x7c\x3f\x20\xb3\x7d\x3d\x00\x79\x4c\x41\xec\x4a\x04\xf4\x45\x28\x00\x49\x45\x1c\xe1\xe7\x10\x75\x00\xf0\x6a\x2c\x5e\x7e\xe9\x57\x9c\x43\xf2\xaa\x44\xdf\xb0\x68\xea\x2c\xd5\x75\x00\x33\xa3\x86\xcb\xd1\xed\x65\x56\x3d\x7f\x75\x00\x93\x84\x5d\x6e\x01\xd7\xa6\xdd\x41\x00\x19\xf2\x3d\x00\xe1\x84\x3d\x00\x36\x61\x51\x26\x07\x6a\x75\x00\xb5\x5a\x59\xb2\x8d\x81\x6c\x55\x04\x0f\xba\x14\x3d\x00\x38\xe6\x75\x00\x11\x00\x26\xba\x3d\x00\xfe\x49\x2c\xdc\x75\x00\x88\x7a\xf8\x72\x11\x00\xf1\xc2\xc1\x52\x50\xc6\x42\x48\x69\x0f\x19\x5f\xa8\xb6\x20\x2a\x21\xef\xf7\xf2\x28\x00\xbd\x49\x90\x00\xdd\x1d\x7a\x00\xe2\x3f\x93\x57\x75\x00\xc1\x63\x3d\x00\xab\x03\x52\x00\x8f\x2d\x28\x00\x17\x19\x77\x20\xc0\x2f\xc9\x81\xf8\x2b\xc9\x38\xd5\xa4\x2d\x74\x61\xc9\xb5\x4d\x54\x46\x75\x00\x7a\x00\x52\x00\x41\x00\x52\x00\xaa\x72\x90\x00\x90\x00\x7a\x00\x41\x00\x11\x00\x11\x00\x28\x00\x28\x00\x51\x00\x00\x00\xb0\x01\x00\x00\x75\x00\x80\x5c\x9f\x64\x14\x91\x52\x3d\x00\xbb\x80\x11\x8c\x75\x00\x2c\xc2\x45\x2d\x7a\x00\x50\x32\x75\x00\x10\xc2\xc8\xc5\x28\x00\x75\x00\x52\x00\x1d\xad\x75\x00\xfe\x11\x41\x00\x11\x00\xe2\xbc\x75\x00\x11\x00\x90\x00\xaf\xf6\x1e\xae\x89\x75\x00\xb8\x73\xf8\x3e\xa6\x61\x93\x39\x75\x00\x3f\x8b\xe8\xf8\x75\x00\xe3\x3c\xf9\xf4\x90\x00\xb3\x44\x3d\x00\xce\x7e\x75\x00\x90\x89\xbe\xd9\x3b\x4b\x11\x44\x3d\x00\x35\xa8\x08\x3a\x21\x04\x24\xee\xc5\x41\x18\xe7\x75\x00\x90\x00\xd1\x78\xb7\x8e\x3f\x1f\x75\x00\x28\x00\x11\x00\x7d\x5a\x3d\x00\x8d\x79\x52\x00\x41\x00\x16\x94\x7d\xb0\x3a\x90\x75\x00\xe5\x10\x06\x42\x3d\x00\x66\x10\x11\x44\x3d\x00\x00\x30\x09\x14\x46\x16\xc6\x2e\x18\xb3\xf5\x03\x9f\xbe\x52\x00\xe9\x1d\xc5\xaf\xcb\xcd\x75\x00\x11\x00\x11\x00\x73\x5e\xbc\x51\x93\xee\x75\x00\x3d\x00\xfc\x02\x41\x00\x4b\x04\x90\x00\x75\x00\x8a\xfe\x41\x00\x35\x9c\xa3\x52\x68\xa9\x9d\x59\x92\x1c\xd0\xca\x95\x49\xa4\xed\x1f\x1b\x63\xb2\x75\x00\x24\x6b\x50\xcb\xd7\xeb\x0e\x8a\x5c\xed\x50\xe5\xd1\x43\x4f\x5a\xcf\xfb\xe6\x99\x4f\x7d\x3f\xfe\x52\x00\x11\x00\x75\x00\x3d\x00\xf8\xeb\x04\xad\x50\x1f\x3c\x48\x75\x00\x36\xc1\xae\x16\x6f\x83\x3d\x00\x83\xde\x0d\x53\x2a\xed\x75\xfb\x90\x00\x88\x66\x28\x00\x90\x00\xb1\x51\x28\x00\x2c\x63\x75\x00\x75\x00\x54\xce\xe2\x09\xbf\x0e\xa1\x5b\x00\x65\xb4\x08\x1f\x51\x29\xcd\x4e\x97\x09\x79\x00\xea\xad\x21\x41\x00\x52\x00\x75\x00\x2b\x03\x18\xf4\xe3\x48\x90\x00\x18\x5d\x43\x16\xb0\x4f\x75\x00\x41\x00\x52\x00\x52\x00\x02\x63\x7a\x00\x75\x00\x75\x00\x73\x3c\x05\xc7\x3d\x00\x76\x86\xbd\x03\x41\x98\x98\x2b\x9e\x7f\xcf\x24\xd6\x48\x62\x48\x90\x00\x3d\x00\xb1\x35\x7a\x00\x52\x00\x41\x00\x90\x00\xb4\xfa\x90\x00\x41\x00\x11\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x28\x00\x49\x03\xac\x88\x50\xf5\x39\x59\x26\xa1\x0f\x28\x3b\xd3\x3d\x00\x31\xf8\x64\x2d\x12\x1f\xc6\xb9\xc8\x79\x8e\xee\x89\xfe\x75\x00\x63\x6f\x28\x00\x3c\x51\x3f\x12\x28\x00\x16\x10\x77\x77\x28\x00\x3c\x51\x75\x00\x41\x00\x75\x00\x20\xd8\xb1\xf9\x05\x21\x95\x62\x3f\x00\x90\x00\x7a\x00\x75\x00\x70\x7c\xe9\x0a\xf0\x5d\x33\x8d\x52\x80\x3d\x00\x3d\x00\x8c\xd1\xcb\xf5\x3d\x00\x07\x0f\xe1\x98\x51\x11\x47\x96\x25\x03\x3d\x00\xa7\xe6\x75\x00\x11\x00\xfe\xb8\x3d\x00\xe8\xd3\x3a\xae\x1b\xc3\x55\xf1\x9c\xc0\x7b\x23\xa9\x3e\x7a\x00\x7a\x00\x75\x00\x66\x9f\xc8\x67\xe1\xd8\x3a\x2d\x75\x00\x49\xad\x92\x04\x02\x61\x3d\x00\x38\x52\xdc\xc9\x87\xf0\x4f\x3c\xc3\x57\x53\x02\xf1\x82\x59\x7c\x41\x00\x3d\x00\x93\x87\xb2\x9c\x3d\x00\x4b\x92\x2d\x89\x1a\x6a\xbb\xb2\x41\x00\xaa\x86\x3d\x00\xe0\x75\x75\x00\x90\x00\x5d\xb8\x3d\x00\x74\xbd\xc8\x9a\xcb\x17\xb1\x8c\x00\x21\x75\x00\xcf\x50\x7f\x4f\x60\x02\xea\xd8\xc8\xb9\xe6\x01\x75\x00\xf1\xf4\xc7\x0f\xec\x5c\x1f\x52\xe0\x40\x2e\x04\x3b\x60\xd1\xc7\xd7\x24\x96\x84\x6b\xb9\x3d\x00\x3d\x00\xdf\x9d\x86\xd5\x13\x6e\x90\x00\x59\xa7\x7a\x00\x3d\x00\x7a\x00\x7c\x88\x52\x00\x28\x00\x5f\x93\x7a\x00\x1d\x83\x75\x00\x75\x00\x57\x14\x4f\x90\x42\x0c\x3d\x00\xba\x14\x06\xcc\x3d\x00\x76\x38\xc7\x43\x3d\x00\x3f\x38\x75\x00\x41\x00\x2e\xb9\x3d\x00\x9c\xde\x75\x00\x11\x00\x3d\x00\x75\x00\x00\x00\x75\x00\x28\x00\x39\xb8\x3d\x00\x41\x00\x75\x00\x28\x00\x39\xb8\x3d\x00\x31\x00\x75\x00\x52\x00\xc4\xba\x3d\x00\xba\x14\x53\x37\x3d\x00\x21\x69\x06\x42\x3d\x00\x01\x68\xc7\x43\x3d\x00\xd7\x38\x75\x00\x52\x00\x28\xb9\x3d\x00\x7a\x00\x52\x00\x41\x00\x41\x00\x06\x53\x90\x00\x7a\x00\x11\x00\x28\x00\x11\x00\x52\x00\x28\x00\x90\x00\x88\x4e\x82\x67\x41\x01\x20\x00\x80\xce\x68\x00\x3d\x00\x51\x00\xac\x02\x41\x00\x7a\x00\x1e\x5b\x3d\x00\x34\xfb\x33\xb4\xaa\xd7\x3d\x00\x3d\x00\x1c\x16\x85\xac\x80\x03\xa6\x3c\x42\x11\xcb\x26\x52\x83\xfc\x1c\x90\x00\x3d\x00\x12\x02\x41\x00\x3e\xbf\x41\x00\x3d\x00\xc3\x17\xce\xb2\x12\x97\x48\x70\x24\x22\xc5\x06\x8d\x08\xf4\x0c\x28\x00\x65\x4d\x11\x00\xbd\x4c\x3d\x00\xe8\x8d\x2c\x71\x3d\x00\x14\x8c\x5a\x6b\x3d\x00\x19\xe0\x75\x00\x11\x00\x3d\x00\x79\x92\x08\x3d\x00\x05\xc5\x8a\x45\xe2\x4f\xe3\x62\xc2\x62\xde\xfa\x99\x4d\x7d\x46\xe4\x1a\xce\x32\xb8\xee\xbf\xcc\x4c\x93\x39\x8b\x4f\x23\xb6\x53\xae\x32\x22\x66\x7c\x35\x30\xf5\x31\xf8\x97\xa8\x75\x00\x3d\x00\x67\x53\x5e\xd3\x3d\x00\x7e\x2e\x36\x00\x5a\x5f\x57\x49\x90\x00\x6a\xb1\x28\x00\x52\x00\xda\x15\x41\x00\xf5\xdf\x75\x00\x75\x00\xdd\x01\x75\x00\x90\x00\x99\xb9\x3d\x00\x11\x00\x27\x1f\x6b\xae\x90\x00\x34\x99\x75\x00\x52\x00\x75\x00\x77\x1f\x05\xb9\x15\x41\x3d\x00\x86\xff\x28\x00\x98\xd7\x9b\xad\x6c\x17\x75\x00\x2d\x04\x0c\xad\x86\x14\x1d\x98\x3d\x00\x86\x14\x05\x05\x3d\x00\x6c\x17\xdb\xfb\x3d\x00\x9c\xde\x75\x00\x7a\x00\x3d\x00\x75\x00\xff\x5c\x75\x00\x11\x00\xf8\xba\x3d\x00\xa9\x77\xc7\x43\x3d\x00\x86\x38\x75\x00\x90\x00\xc4\xba\x3d\x00\xba\x14\x2c\x0c\x3d\x00\xbc\x34\x06\x42\x3d\x00\x15\xf4\x02\x42\x3d\x00\x6a\x17\x16\x90\x3d\x00\x7a\x00\x52\x00\x41\x00\x7a\x00\x55\x13\x90\x00\x28\x00\x90\x00\x41\x00\x11\x00\x11\x00\x28\x00\x52\x00\x4d\x0f\x91\x67\x41\x01\x20\x00\x80\x07\x0b\x00\x3d\x00\x51\x00\xf5\x04\x6f\x6d\x46\x26\x3d\x00\xe8\x00\xd0\x26\x3d\x00\x3d\x00\xfe\x2a\xc5\xdd\x05\x36\x9e\x73\xc4\x8e\xb0\x74\x84\xc6\x10\x7c\x28\x00\x90\x00\x11\x00\xd5\x58\x3d\x00\x5d\xab\x41\x00\x11\x00\x3b\x58\x3d\x00\x10\xb6\x3d\x00\x73\x88\xcd\xfb\xe1\xd9\xd2\x59\xc6\xdb\x92\x3a\x59\x5e\xb5\x7e\x11\x00\x3d\x00\x2c\x3b\xbf\xff\x43\x88\x79\x2b\x2b\x47\x75\x19\xf3\xc1\x0c\x55\x7a\x00\x9c\x4d\x11\x00\xcf\x5f\x3d\x00\xee\xc8\x75\x00\x3d\x00\x05\x77\x08\x3d\x00\x82\xbf\x50\xd5\x8f\xb1\x63\xa3\x87\x38\xf3\xe8\xfa\x70\x57\x02\x49\x05\xb8\x48\x13\xe6\x54\xbf\x90\x3f\x7b\xfa\x75\x00\x15\x26\x7a\x00\x96\x5c\xbb\xcf\x36\x6f\x0f\x26\xb8\xf3\x78\x85\xac\x8a\xff\x40\x99\xb6\x82\x93\x65\x1f\x34\xab\xe3\xfa\xe2\x05\xc0\x4e\x82\xdd\xb3\x0f\x75\x00\x3d\x00\x1c\x85\x41\x00\x90\x00\x0e\xae\x8c\xfc\x41\x9a\x75\x00\x85\x06\xdc\x42\x3d\x00\xdb\xdc\x75\x00\x41\x00\x3d\x00\x75\x00\x87\xc8\x06\x42\x3d\x00\x76\xc8\x06\x42\x3d\x00\x30\x00\x02\x42\x3d\x00\x7b\x16\x3c\xd5\x3d\x00\xa3\x5c\x75\x00\x7a\x00\xc4\xba\x3d\x00\xba\x14\x79\xfd\x3d\x00\xf7\x34\xd6\x42\x3d\x00\x7a\x00\x52\x00\x41\x00\x11\x00\x23\xed\x90\x00\x28\x00\x41\x00\x7a\x00\x11\x00\x52\x00\x28\x00\x90\x00\x51\xf0\x3a\x4e\x59\x00\x20\x00\x68\xf8\x64\x41\x01'

state.esp = 0x6F8A8
state.VMA = 0x10f0429c ##Where VM registers in mem
TVM.VMA = 0x10f0429c

state.push(0x12345678)
state.push(0x257)

tmp = state.esp

state.push(0xFF0F0000) #eflags
state.push(0xFF1F0000) #eax
state.push(0xFF2F0000) #ecx
state.push(0xFF3F0000) #edx
state.push(0xFF4F0000) #ebx
state.push(tmp) #esp
state.push(0xFF6F0000) #ebp
state.push(0xFF7F0000) #esi
state.push(0xFF8F0000) #edi

state.reg4[TVM.R_EIP] = 0
state.reg4[TVM.R_31] = 0xFCB2A014
state.reg4[TVM.R_ImgBase] = 0x10000000 #imgBase


state.wMem(0x000A2EC0, b'\x0A\xB2\xAC\x0A')


state.wMem(0x10EFD721, b'\x4e\x67\x9b\xb8')
state.wMem(0x1103f789, b'\x08\x10\x43\x11') #0x11431008
state.wMem(0x11431008, b'\x0A\xB2\xAC\x0A')

state.wMem(0x11062511, b'\x0C\xFD\x6D\x1F')
state.wMem(0x110B727D, b'\x69\x7A\xB8\xED')
state.wMem(0x1105915F, b'\x59\x89\xC1\x58')
state.wMem(0x1109D8BB, b'\x7F\xA5\xEC\x70')
state.wMem(0x110AA61B, b'\x10\xBF\xEE\x94')
state.wMem(0x110BCE23, b'\x73\x58\x01\xF3')



state.wMem(0x7D0B736F, b'\xFF\xFF\xF7\xFF')
state.wMem(0x7C80003C, b'\x0F\x00\x00\x00')
state.wMem(0x7C800117, b'\x00\x3E\xB6\x00')

##7C800000 - kernel32

state.AddRoute(0x257, 0)

state.OnEnd = FNC
#state.AddRoute(0x444, 0, False)

PARSED, ERR = TVM.Parse(state)
for k,v in sorted(PARSED.items()):
	for l in v:
		print(l)
		pass
	print()


for l in ERR:
	print(l)
	pass
